# Baby Game 1

**Flag:** `picoCTF{gamer_m0d3_enabled_6aeb6b85}`

- **step 1**

    Just by pressing random keys, i figured out that the game used the common WASD keybindings to move around, and p directly moved the player to the endpoint. however just doing this did not give the flag, something else needed to be done first.

- **step 2**

    Using Decompiler Explorer, I got the equivalent C program for the game. It had a win function that printed the flag from flag.txt

    It had an if statement that checked if a particular variable (fp) was 0. If the value was 0 it wouldnt print the flag, so I had to find some way to change its value.


- **step 3**

    The only possible way to do it would be to move around, and looking around i realised that there is no bound for the player position (effectively allowing the player to move outside and get negative coordinates)

    `*(undefined *)(*param_1 * 0x5a + param_3 + param_1[1]) = player_tile;\`

    which is the same as

    `*mat[(player_y_pos * 0x5a) + player_x_pos)] = player_title`

    This is basically allowing us to use pointers to point to anywhere and storing a value

- **step 4**

    Now to figure out which position would give us the address for (fp)

    Looking at the stack, the variable fp was just below player_x_pos. 

    Which gave us the position of (0,-4) since we only wanted to change the LSB, since thats what is actually checked.

- **step 5**

    Therefore the plan was to , first move to (0,-4) using `a` (to move left) since the player started at (4,4) (`distances are represented in the format of (y_pos,x_pos)`) , and then press p to win the game.

    This worked and I got the flag.

**What I learned:**

1. Analysing Decompiled C code (very similar to deobfuscation)

2. A little bit about how stack memory works.

**Other incorrect methods I tried:**

- Tried a way to bruteforce and move the character to every position, but this was both difficult and didnt give the flag(since i had unfortunately limited it to the map boundary)

**References**

- https://dogbolt.org/?id=3b1456fc-43f7-41df-ac31-a4db11e832d2#BinaryNinja=441

- https://stackoverflow.com/questions/12338432/how-to-decompile-a-elf-32-bit-lsb-executable