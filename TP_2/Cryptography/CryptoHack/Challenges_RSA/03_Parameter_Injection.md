# Parameter Injection

**Flag:** `crypto{n1c3_0n3_m4ll0ry!!!!!!!!}`

- **step 1**

    Using my own prime number, I caculated g^z mod p and sent that to alice, alice then encrypted her message using z rather than bobs key, and sinze i had access to A, i could generate the secret as well. Using that and the decrypt algorithm provided by cryptohack, I could decrypt the flag.

    ```
    (base) fiendfyre@fedora:~$ nc socket.cryptohack.org 13371
    Intercepted from Alice: {"p": "0xffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece45b3dc2007cb8a163bf0598da48361c55d39a69163fa8fd24cf5f83655d23dca3ad961c62f356208552bb9ed529077096966d670c354e4abc9804f1746c08ca237327ffffffffffffffff", "g": "0x02", "A": "0xe1997c800572a08f51334a614a8dc653cf4a7a8df37efc5078be6b5d98d38f941217a802ed66ce0af9cb6dcaefb29d0cb00191d692ce64694870e31bade36f479f2c9164fced4d65d37f33302629ecae39a418681368f809fd19dd3056fcb1157df14b74ac1a29b859ad68d73f1aee2de6bb9729507c8a8fb106422e3529e6e20d1aee48341b17577359b8bfcbc730310ad5b1333947fc236491f816bd2f3bc575b77dc846947420a3793f5a8473a9672faf04c936381177c1e0c9bfaada8a24"}
    Send to Bob: {"p": "0xffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece45b3dc2007cb8a163bf0598da48361c55d39a69163fa8fd24cf5f83655d23dca3ad961c62f356208552bb9ed529077096966d670c354e4abc9804f1746c08ca237327ffffffffffffffff", "g": "0x02", "A": "0x83e907190b6484aa982847f873111a28a3f1a0617a0973b24f8ed036d01d01009f050fa636cfe030cdd26f1309465cdea4ebc97d421fa5ebeedda63d948c8b00e81c8e8e63e720ad74bf867139ac2112883928d0441290f9f40e67a44e4447b7f8841f6f573b8b6a85d679bb611d7f026a4c2c904dd4a97a2d0048531f43b78e7c539d9e59149229ed32630506d11f13b42609bb4b8c4644e0f3ede537022ac7de96288c1794746f3f57b25a2668363a4314879c3834a9961ba3800f7de4798d"}
    Intercepted from Bob: {"B": "0x6d2fe21fce5cbc011f642cf33633cd621aad3492bd4b8ac5c5d8a894406865142cf5fd5f935b069891a5232ac8b6d851c44aed14160016891b4feffc800de52b50681fe70a227660fe7897713ce3e7f9f6aae3c90f4dd24720753b1126e43bd2abecd513504ba0768b49dd084d2e173ee4bc13c07dd913422ccff4a618a10cae0ec935cf2f3195bd7b2e72ae1643400b3d4d6e74b5c4427b40127a079fe6b5611f605838f61d43ea9d3eb4e588eaa61ac6aa0cdf2a93f34457a58ce8a6a4cc6e"}
    Send to Alice: {"B": "0x83e907190b6484aa982847f873111a28a3f1a0617a0973b24f8ed036d01d01009f050fa636cfe030cdd26f1309465cdea4ebc97d421fa5ebeedda63d948c8b00e81c8e8e63e720ad74bf867139ac2112883928d0441290f9f40e67a44e4447b7f8841f6f573b8b6a85d679bb611d7f026a4c2c904dd4a97a2d0048531f43b78e7c539d9e59149229ed32630506d11f13b42609bb4b8c4644e0f3ede537022ac7de96288c1794746f3f57b25a2668363a4314879c3834a9961ba3800f7de4798d"}
    Intercepted from Alice: {"iv": "52a8a7704af29b3749cedb21976d6840", "encrypted_flag": "57a062402c4434ddd3d57b938bc3e3f2d3e49a41bd222960f612af92d2c6b59c"}
    ```


**What I learned:**

1. Diffie-Hellman key exchange 

**Other incorrect methods I tried:**

- None

**References**

- https://youtu.be/Yjrfm_oRO0w